<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Lessons | Fireship English Lessons</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* --- Base Style Variables --- */
     :root {
      --primary-color: #4361ee; --accent-color: #3a0ca3; --light-color: #f8f9fa; --dark-color: #212529; --success-color: #4cc9f0; --danger-color: #f72585; --border-radius: 8px; --box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08); --border-color: #e9ecef; --transition-speed: 0.3s; --transition-timing: cubic-bezier(0.4, 0, 0.2, 1); /* Added danger color */
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Poppins', sans-serif; background: linear-gradient(to bottom, #ffffff, #eaf2ff); min-height: 100vh; color: var(--dark-color); padding: 0; margin: 0; padding-top: 70px; /* Increased padding for taller header */ }

    /* --- Header Styles --- */
    header.main-header {
        background-color: white; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); padding: 0 2rem; /* Adjusted padding */ position: fixed; top: 0; left: 0; right: 0; z-index: 1000; display: flex; justify-content: space-between; /* Space between logo and profile */ align-items: center; height: 70px; /* Standard height */ border-bottom: 1px solid var(--border-color);
    }
     body.scrolled header.main-header { background-color: rgba(255, 255, 255, 0.97); box-shadow: 0 6px 25px rgba(0, 0, 0, 0.06); }

    /* Logo Area */
    .header-logo-link { display: flex; align-items: center; text-decoration: none; height: 100%; } /* Make logo clickable */
    .header-logo { display: flex; align-items: center; height: 40px; /* Consistent height */ overflow: visible; }
    .header-logo img { height: 80px; /* Keep original size */ margin-right: 0.8rem; transform: translateY(-7px); /* Keep original transform */ }
    .header-logo span { font-weight: 700; font-size: 1.3rem; color: var(--primary-color); }

    /* User Profile Header (Copied from Index.html styles) */
    .user-profile-header { display: none; /* Hidden by default, shown by JS */ align-items: center; gap: 12px; position: relative; cursor: pointer; }
    .user-avatar { width: 40px; height: 40px; border-radius: 50%; border: 2px solid var(--border-color); object-fit: cover; background-color: #eee; /* Placeholder */ }
    .user-name-header { font-weight: 600; color: var(--dark-color); max-width: 150px; /* Limit width */ white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .notification-dot { width: 10px; height: 10px; background-color: var(--accent-color); /* Use accent for notifications */ border-radius: 50%; position: absolute; top: 0; right: 0; border: 1.5px solid white; display: none; /* Hidden by default */ }
    .profile-dropdown { display: none; /* Hidden by default */ position: absolute; top: calc(100% + 10px); /* Position below header */ right: 0; background-color: white; border-radius: var(--border-radius); box-shadow: 0 8px 25px rgba(0,0,0,0.1); border: 1px solid var(--border-color); z-index: 1010; min-width: 200px; /* Slightly wider */ overflow: hidden; list-style: none; padding: 8px 0; }
    .profile-dropdown a, .profile-dropdown button { display: flex; /* Use flex for alignment */ align-items: center; width: 100%; text-align: left; padding: 10px 18px; /* Adjusted padding */ color: var(--dark-color); text-decoration: none; font-size: 0.9rem; /* Slightly smaller */ font-weight: 500; background: none; border: none; cursor: pointer; transition: background-color 0.2s ease, color 0.2s ease; white-space: nowrap; }
    .profile-dropdown a:hover, .profile-dropdown button:hover { background-color: var(--bg-light); color: var(--primary-color); }
    .profile-dropdown a i, .profile-dropdown button i { margin-right: 12px; /* Increased space */ color: var(--gray-color); transition: color 0.2s ease; width: 16px; /* Fixed icon width */ text-align: center; }
    .profile-dropdown a:hover i, .profile-dropdown button:hover i { color: var(--primary-color); }
    .dropdown-divider { height: 1px; background-color: var(--border-color); margin: 8px 0; }
    .lessons-link span { flex-grow: 1; } /* Allow text to take space */
    .lessons-link .notification-dot { position: static; display: inline-block; margin-left: 8px; width: 8px; height: 8px; vertical-align: middle; background-color: var(--accent-color); border-radius: 50%; border: 1px solid white; visibility: hidden; /* Hidden by default */ }
     .lessons-link .notification-dot.visible { visibility: visible; } /* Show dot when needed */
    /* Sign In Link (Copied from Index.html, hidden when profile shown) */
    #signInLink { display: none; /* Hidden by default on pages requiring login */ color: var(--primary-color); background-color: transparent; text-decoration: none; font-weight: 600; padding: 8px 18px; border: 2px solid var(--primary-color); border-radius: 50px; transition: all var(--transition-speed) var(--transition-timing); }
    #signInLink:hover { background-color: var(--primary-color); color: white; box-shadow: 0 5px 15px rgba(90, 141, 238, 0.2); transform: translateY(-2px); }


    /* --- Main Lessons Content Styles (Keep as before) --- */
    .lessons-page-container { max-width: 900px; margin: 40px auto; padding: 2rem; background-color: white; border-radius: var(--border-radius); box-shadow: var(--box-shadow); overflow: hidden; }
    .page-title { font-size: 2rem; font-weight: 600; margin-bottom: 2rem; color: var(--dark-color); display: flex; align-items: center; border-bottom: 1px solid var(--border-color); padding-bottom: 1rem; }
    .page-title i { margin-right: 1rem; color: var(--primary-color); font-size: 1.8rem; }
    .lessons-list { display: flex; flex-direction: column; gap: 1rem; min-height: 150px; position: relative; }
    .list-loading-spinner { position: absolute; top: 40px; left: 50%; transform: translateX(-50%); width: 40px; height: 40px; border: 4px solid var(--border-color); border-top: 4px solid var(--primary-color); border-radius: 50%; animation: spin 1s linear infinite; display: none; }
    @keyframes spin { 0% { transform: translateX(-50%) rotate(0deg); } 100% { transform: translateX(-50%) rotate(360deg); } }
    .lesson-card { background-color: var(--light-color); border-radius: var(--border-radius); padding: 1.5rem; transition: transform 0.3s, box-shadow 0.3s; border-left: 4px solid var(--primary-color); display: flex; justify-content: space-between; border: 1px solid var(--border-color); opacity: 0; animation: fadeIn 0.5s ease forwards; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    .lesson-card:hover { transform: translateY(-3px); box-shadow: 0 8px 15px rgba(0, 0, 0, 0.08); }
    .lesson-details h3 { font-size: 1.2rem; margin-bottom: 0.5rem; color: var(--dark-color); font-weight: 600; }
    .lesson-details p { color: #6c757d; margin-bottom: 0.5rem; font-size: 0.9rem; display: flex; align-items: center; gap: 8px; }
    .lesson-details p i { color: var(--primary-color); width: 14px; text-align: center; }
    .lesson-details .teacher { display: flex; align-items: center; font-size: 0.85rem; margin-top: 0.8rem; }
    .teacher-avatar { width: 24px; height: 24px; border-radius: 50%; margin-right: 0.75rem; border: 1px solid var(--border-color); background-color: #eee; }
    .lesson-actions { display: flex; align-items: center; gap: 0.75rem; flex-shrink: 0; flex-wrap: wrap; /* Allow buttons to wrap */ }
    .btn { background-color: white; color: var(--primary-color); border: 1px solid var(--primary-color); padding: 8px 12px; border-radius: var(--border-radius); cursor: pointer; font-family: 'Poppins', sans-serif; font-weight: 500; font-size: 0.85rem; transition: all 0.3s; display: inline-flex; align-items: center; text-decoration: none; }
    .btn i { margin-right: 6px; }
    .btn-primary { background-color: var(--primary-color); color: white; }
    .btn-secondary { background-color: var(--success-color); color: white; border-color: var(--success-color); } .btn-secondary:hover { background-color: #3ab0c9; border-color: #3ab0c9; }
    .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); }
    .btn-primary:hover { background-color: var(--accent-color); border-color: var(--accent-color); }
    .btn-danger { color: #dc3545; border-color: #dc3545; } .btn-danger:hover { background-color: rgba(220, 53, 69, 0.1); }
    .empty-state, .error-state { text-align: center; padding: 3rem 1rem; color: #6c757d; border: 1px dashed var(--border-color); border-radius: var(--border-radius); background-color: var(--light-color); display: none; /* Hidden by default */ }
    .empty-state i.icon, .error-state i.icon { font-size: 3rem; color: #d1d9e6; margin-bottom: 1rem; display: block; }
    .error-state i.icon { color: var(--danger-color); }
    .empty-state h3, .error-state h3 { font-size: 1.3rem; color: var(--dark-color); margin-bottom: 0.5rem; font-weight: 600; }
    .empty-state p, .error-state p { margin-bottom: 1.5rem; }
    .error-state p { color: var(--danger-color); }
    /* Responsive */
     @media (max-width: 768px) { body { padding-top: 70px; } header.main-header{ height: 70px; padding: 0 1.5rem;} .lessons-page-container { margin: 20px; padding: 1.5rem; } .page-title { font-size: 1.6rem; margin-bottom: 1.5rem; } .lesson-card { flex-direction: column; gap: 1rem; } .lesson-actions { margin-top: 1rem; justify-content: flex-start; } }
     @media (max-width: 480px) { .lesson-actions { flex-wrap: wrap; justify-content: flex-start; } .btn { width: auto; /* Allow natural width */ margin-bottom: 5px; } }

  </style>
</head>
<body>
  <!-- Header - Now includes Profile Area -->
  <header class="main-header">
    <a href="Index.html" class="header-logo-link"> <!-- Logo Link -->
        <div class="header-logo">
            <img src="https://imgur.com/bXjTJAj.png" alt="Fireship Logo">
            <span>Fireship</span>
        </div>
    </a>
    <!-- Sign In Link (Hidden by default on this page, shown if auth fails) -->
    <a href="welcome.html?source=signIn" id="signInLink">Sign In</a>
    <!-- User Profile Area (Copied from Index.html) -->
    <div class="user-profile-header" id="user-profile-header">
         <span class="user-name-header" id="userNameHeader">User</span>
         <img src="placeholder-avatar.png" alt="User Avatar" class="user-avatar" id="userAvatarHeader">
         <div class="notification-dot" id="notificationDot"></div> <!-- Main dot -->
         <div class="profile-dropdown" id="profileDropdown">
             <a href="profile.html"><i class="fas fa-user-circle"></i> My Profile</a>
             <a href="lessons.html" class="lessons-link">
                 <i class="fas fa-calendar-check"></i>
                 <span>My Lessons</span>
                 <span class="notification-dot" id="lessonsNotificationDot"></span> <!-- Dot inside link -->
             </a>
             <div class="dropdown-divider"></div>
             <button id="signOutBtn"><i class="fas fa-sign-out-alt"></i> Sign Out</button>
         </div>
    </div>
  </header>

  <!-- Main Lessons Content -->
  <div class="lessons-page-container">
    <h1 class="page-title"> <i class="fas fa-calendar-alt"></i> My Booked Lessons </h1>
    <div class="lessons-list" id="lessons-list">
       <div class="list-loading-spinner" id="loadingSpinner"></div>
       <div class="empty-state" id="empty-state">
         <i class="fas fa-calendar-xmark icon"></i>
         <h3>No lessons booked yet</h3>
         <p>Book your first English lesson to start your learning journey!</p>
         <a href="booking.html" class="btn btn-primary"> <i class="fas fa-plus"></i> Book a Lesson </a>
       </div>
       <div class="error-state" id="error-state">
         <i class="fas fa-exclamation-circle icon"></i>
         <h3>Could not load lessons</h3>
         <p>There was an error fetching your lessons. Please try refreshing the page.</p>
         <button class="btn btn-primary" onclick="fetchAndDisplayLessons()"> <i class="fas fa-sync-alt"></i> Retry </button>
       </div>
      <!-- Lesson cards dynamically added here -->
    </div>
  </div>

 <script>
    // --- DOM Elements ---
    const lessonsListContainer = getElement('lessons-list');
    const emptyStateDiv = getElement('empty-state');
    const errorStateDiv = getElement('error-state');
    const loadingSpinner = getElement('loadingSpinner');
    // --- Header Elements (NEW) ---
    const signInLink = getElement('signInLink');
    const userProfileHeader = getElement('user-profile-header');
    const userNameHeader = getElement('userNameHeader');
    const userAvatarHeader = getElement('userAvatarHeader');
    const profileDropdown = getElement('profileDropdown');
    const signOutBtn = getElement('signOutBtn');
    const notificationDot = getElement('notificationDot'); // Main dot on avatar
    const lessonsNotificationDot = getElement('lessonsNotificationDot'); // Dot in dropdown

    // --- Utilities & Core Logic ---

    // Add this line BEFORE the apiRequest function definition
    const API_BASE_URL = 'https://api.fireship.org'; // <-- YOUR LIVE API URL

    async function apiRequest(url, options) {
         // Construct the full URL if the provided URL starts with '/'
         const fullUrl = url.startsWith('/') ? `${API_BASE_URL}${url}` : url; // Use the constant
         console.debug(`API Req: ${options?.method || 'GET'} ${fullUrl}`); // Log the full URL
         try {
             // Use fullUrl in the fetch call
             const r = await fetch(fullUrl, options); // <--- Ensure this uses fullUrl

             if (!r.ok) {
                 let errorMsg = `API Error (${r.status})`;
                 let errorData = null;
                 try { errorData = await r.json(); errorMsg = errorData.message || errorMsg; } catch (e) { /* ignore if response is not json */ }
                 console.error(`API Fail: ${r.status} ${r.statusText} @ ${fullUrl}`, errorData); // Log fullUrl

                 // Specific 401 handling for this page (redirect to welcome)
                 if (r.status === 401) { // Check specific status
                     console.warn("API 401 -> Welcome");
                     window.location.href = 'welcome.html';
                     return null; // Return null to signal a redirect or halt further processing
                 }
                 // Throw a formatted error for other non-ok statuses
                 throw new Error(errorData?.message || `Request failed: ${r.status}`);
             }

             // Check content type before trying to parse JSON
             const ct = r.headers.get("content-type");
             if (ct?.includes("application/json")) {
                 const d = await r.json();
                 console.debug(`API OK JSON @ ${fullUrl}:`, d); // Log fullUrl
                 return d;
             } else {
                 // Handle non-JSON success responses (like 204 No Content or other types)
                 console.debug(`API OK NoJSON @ ${fullUrl} (${r.status})`); // Log fullUrl
                 // Return an empty object as the original function did
                 return {};
             }
         } catch (e) { // Error handling
              console.error(`API Excep (${fullUrl}):`, e); // <--- Ensure this uses fullUrl
              // Check for network errors (e.g., "Failed to fetch")
              if (e.message.toLowerCase().includes('failed to fetch')) {
                  throw new Error("Network error.");
              }
              // Re-throw original error (could be the custom error from !r.ok or the network error)
              throw e;
         }
    }

    function showLoadingState(isLoading) { /* ... Keep existing ... */ if (loadingSpinner) loadingSpinner.style.display = isLoading ? 'block' : 'none'; if (!isLoading) { if (emptyStateDiv) emptyStateDiv.style.display = 'none'; if (errorStateDiv) errorStateDiv.style.display = 'none'; } }
    function displayLessons(lessons) { /* ... Keep existing ... */ if (!lessonsListContainer) return; lessonsListContainer.querySelectorAll('.lesson-card').forEach(card => card.remove()); if (lessons?.length > 0) { if (emptyStateDiv) emptyStateDiv.style.display = 'none'; if (errorStateDiv) errorStateDiv.style.display = 'none'; lessons.sort((a, b) => new Date(a.utcStartTime) - new Date(b.utcStartTime)); lessons.forEach((lesson, index) => { const lessonCard = createLessonCardElement(lesson); lessonCard.style.animationDelay = `${index * 0.05}s`; lessonsListContainer.appendChild(lessonCard); }); } else { if (emptyStateDiv) emptyStateDiv.style.display = 'block'; if (errorStateDiv) errorStateDiv.style.display = 'none'; } }
    function displayErrorState() { /* ... Keep existing ... */ if (!lessonsListContainer) return; lessonsListContainer.querySelectorAll('.lesson-card').forEach(card => card.remove()); if (emptyStateDiv) emptyStateDiv.style.display = 'none'; if (errorStateDiv) errorStateDiv.style.display = 'block'; }
    function createLessonCardElement(lesson) { /* ... Keep existing ... */ const card = document.createElement('div'); card.className = 'lesson-card animate-in'; card.dataset.lessonId = lesson.id; const startTime = new Date(lesson.utcStartTime); const endTime = new Date(startTime.getTime() + (lesson.durationMinutes || 20) * 60 * 1000); const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }; const timeOptions = { hour: 'numeric', minute: '2-digit', timeZoneName: 'short' }; const formattedDate = startTime.toLocaleDateString(undefined, dateOptions); const formattedStartTime = startTime.toLocaleTimeString(undefined, timeOptions); const formattedEndTime = endTime.toLocaleTimeString(undefined, { hour: 'numeric', minute: '2-digit' }); card.innerHTML = `<div class="lesson-details"><h3>${lesson.title || 'Personalized Session'}</h3><p><i class="far fa-calendar-alt"></i> ${formattedDate}</p><p><i class="far fa-clock"></i> ${formattedStartTime} - ${formattedEndTime}</p><div class="teacher"><img class="teacher-avatar" src="${lesson.instructor?.avatarUrl || 'placeholder-avatar.png'}" alt="Teacher" onerror="this.onerror=null; this.src='placeholder-avatar.png';"><span>${lesson.instructor?.name || 'To be decided'}</span></div></div><div class="lesson-actions"><button class="btn" onclick="rescheduleLesson('${lesson.id}')"><i class="fas fa-edit"></i> Reschedule</button><a href="confirmation.html?lessonId=${lesson.id}" class="btn btn-secondary"><i class="fas fa-video"></i> Join/View</a><button class="btn btn-danger" onclick="cancelLesson('${lesson.id}')"><i class="fas fa-times-circle"></i> Cancel</button></div>`; return card; }
    function rescheduleLesson(lessonId) { /* ... Keep existing ... */ console.log("Reschedule lesson:", lessonId); alert(`Rescheduling requires integration.`); }
    async function cancelLesson(lessonId) { /* ... Keep existing ... */ console.log("Cancel lesson:", lessonId); if (confirm(`Are you sure you want to cancel lesson ${lessonId}? This action cannot be undone.`)) { alert(`Lesson cancellation requires backend integration.`); /* try { showButtonLoading(event.target, true); // Need event passed or find button await apiRequest(`/api/lessons/${lessonId}/cancel`, { method: 'POST' }); showFeedback('Lesson cancelled successfully.', false); fetchAndDisplayLessons(); // Refresh list } catch (error) { console.error('Error cancelling lesson:', error); showFeedback(`Failed to cancel: ${error.message}`, true); } finally { // showButtonLoading(event.target, false); } */ } }

    // --- NEW Header Logic (Copied & Adapted from Index.html - Keep Existing) ---
    function updateHeaderUI(userData, hasBooking) {
         if (userData && userProfileHeader && userNameHeader && userAvatarHeader && signInLink) {
             signInLink.style.display = 'none';
             userProfileHeader.style.display = 'flex'; // Show profile section
             userNameHeader.textContent = userData.name || 'User';
             userAvatarHeader.src = userData.avatarUrl || 'placeholder-avatar.png';
             userAvatarHeader.onerror = () => { userAvatarHeader.src = 'placeholder-avatar.png'; }; // Fallback

             // Notification Dots
             if (notificationDot) notificationDot.style.display = hasBooking ? 'block' : 'none';
             if (lessonsNotificationDot) lessonsNotificationDot.classList.toggle('visible', hasBooking);

         } else if (signInLink && userProfileHeader) {
             // Logged Out State (or error fetching user) - Show Sign In
             signInLink.style.display = 'block'; // Or 'inline-flex' if needed
             userProfileHeader.style.display = 'none';
             if (notificationDot) notificationDot.style.display = 'none';
             if (lessonsNotificationDot) lessonsNotificationDot.classList.remove('visible');
         }
     }

    function setupDropdown() {
         const profileArea = userProfileHeader; // Click area
         if (profileArea && profileDropdown) {
             profileArea.addEventListener('click', (event) => {
                 event.stopPropagation();
                 const isVisible = profileDropdown.style.display === 'block';
                 profileDropdown.style.display = isVisible ? 'none' : 'block';
             });
             // Close dropdown if clicking outside
             window.addEventListener('click', (event) => {
                  if (profileDropdown.style.display === 'block' && !profileArea.contains(event.target)) {
                     profileDropdown.style.display = 'none';
                  }
             });
         }
     }

     async function handleSignOut() {
          console.log("Signing out...");
          try {
                // Use the updated apiRequest
               const result = await apiRequest('/api/auth/logout', { method: 'POST' });
               if (result === null) return; // Redirect happened in apiRequest
               console.log("Logout successful on backend.");
               // Fallback redirect if needed
               window.location.href = 'welcome.html';
          } catch (error) {
               console.error("Sign out failed:", error);
               if (error.message !== "Redirecting") { // Avoid alert on redirect signal
                   alert(`Sign out failed: ${error.message}`); // Inform user
               }
          }
     }

     async function checkAuthAndSetupHeader() {
         console.log("[Header Auth Check] Checking user status...");
         try {
             // Use the updated apiRequest
             const status = await apiRequest('/api/user/status', { method: 'GET' });
             // apiRequest handles 401 redirect, so if we get here, user is logged in or null was returned
             if (status && status.user) {
                  console.log("[Header Auth Check] User logged in:", status.user.name);
                  updateHeaderUI(status.user, status.hasBooking || false);
             } else if (status === null) {
                 // This case happens if apiRequest returned null due to 401, redirect already happened
                 console.log("[Header Auth Check] User not logged in (401 handled).");
                 // updateHeaderUI(null, false); // UI should already reflect logged out state due to redirect
             }
             else {
                 // This case might happen if the status endpoint returns OK but no user (e.g., session exists but user data missing)
                 console.log("[Header Auth Check] User status received but no user data.");
                 updateHeaderUI(null, false); // Treat as logged out
                  // Potentially redirect here too if this state is invalid for the lessons page
                  // window.location.href = 'welcome.html';
             }
         } catch (error) {
              console.warn("[Header Auth Check] Could not fetch user status:", error.message);
              updateHeaderUI(null, false); // Assume logged out on error, show Sign In
               // Redirect here if auth error means user cannot see lessons page
               // window.location.href = 'welcome.html';
         }
     }
     // --- End NEW Header Logic ---


    // --- Data Fetching (Modified to call header setup) ---
    async function fetchAndDisplayLessons() {
        showLoadingState(true);
        try {
            // Check auth status first (this will also update header and potentially redirect)
            await checkAuthAndSetupHeader();

            // Fetch lessons (will redirect via apiRequest if not authenticated)
            const response = await apiRequest('/api/user/lessons', { method: 'GET' });
            if (response === null) return; // Stop if redirected by checkAuth or apiRequest

            const lessons = Array.isArray(response?.lessons) ? response.lessons : [];
            console.log("Fetched lessons:", lessons);
            displayLessons(lessons);
        } catch (error) {
            console.error('Error fetching lessons:', error);
             // Don't show sign-in link on error fetching lessons if user might still be logged in
             // Only display the error state for the lesson list itself.
            displayErrorState();
        } finally {
            showLoadingState(false);
        }
    }

    // --- Initialization ---
     window.addEventListener('DOMContentLoaded', function() {
        console.log("Lessons Page DOM Loaded");
        fetchAndDisplayLessons(); // Fetch lessons AND setup header
        setupDropdown(); // Setup dropdown click listener
        if(signOutBtn) {
             signOutBtn.addEventListener('click', handleSignOut); // Setup signout listener
        }
         // Scroll listener for header style change
        window.addEventListener('scroll', function() {
            document.body.classList.toggle('scrolled', window.scrollY > 50);
        }, { passive: true });
     });

     // Helper function to get element by ID (avoids repeating document.getElementById)
     function getElement(id) {
         const el = document.getElementById(id);
         // Optional: Add error handling if element not found
         if (!el) {
             console.error(`Element with ID "${id}" not found.`);
         }
         return el;
     }

  </script> 
</body>
</html>